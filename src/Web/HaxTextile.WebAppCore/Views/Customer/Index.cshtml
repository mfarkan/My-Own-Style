@{
    Layout = "_AdminLayout";
}
@using Core.Enumarations
@using HaxTextile.WebAppCore.Models.Customer
@model CustomerSearchRequestDTO
<title>Müşteri İşlemleri</title>
<script src="~/jQueryDataTable/jquery.dataTables.min.js"></script>
<div class="container-fluid">
    <div class="col-md-12">
        <div class="row">
            <div class="col-12 grid-margin">
                <div class="card shadow">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Müşteri İşlemleri</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label">Müşteri İsim:</label>
                                    <div class="col-sm-8">
                                        <input type="text" asp-for="CustomerName" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label">Müşteri Tip:</label>
                                    <div class="col-sm-8">
                                        @Html.DropDownListFor(q => q.CustomerType, Html.GetEnumSelectList<CustomerType>(), "Seçiniz.", new { @class = "form-control" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label">Müşteri Mail:</label>
                                    <div class="col-sm-8">
                                        <input type="email" asp-for="CustomerEmail" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group row">
                                    <label class="col-sm-4 col-form-label">Müşteri Telefon:</label>
                                    <div class="col-sm-8">
                                        <input type="text" asp-for="CustomerPhoneNumber" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-8">
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-info"><i class="fa fa-search"></i> Müşteri Ara</button>
                                <button class="btn btn-info"><i class="fa fa-plus"></i> Yeni Müşteri</button>
                            </div>
                        </div>
                        <br />
                        <div class="col-md-12">
                            <table id="datatable-ApiList" class="table table-striped table-bordered dt-responsive nowrap tableSC" cellspacing="0" width="100%">
                                <thead>
                                    <tr class="text-center">
                                        <th>Müşteri Adı</th>
                                        <th>Müşteri Telefon</th>
                                        <th>Müşteri Tip</th>
                                        <th>Müşteri Açıklama</th>
                                        <th>Müşteri Mail</th>
                                        @*<th>@Html.LabelFor(model => model.Name)</th>
                                            <th>@Html.LabelFor(model => model.DisplayName)</th>
                                            <th>@Html.LabelFor(model => model.Description)</th>*@
                                        <th style="width:80px;">#</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<link href="~/jQueryDataTable/dataTables.bootstrap4.min.css" rel="stylesheet" />
<script src="~/jQueryDataTable/dataTables.bootstrap4.min.js"></script>
@section Scripts
{
    <script>
        function Update(id) {
            console.log(id);
        }
        function Delete(id) {
            console.log(id);
        }
        var DataListGrid = null;
        function fillDataList() {
            if (DataListGrid != null)
                DataListGrid.destroy();
            var grid = $('#datatable-ApiList').DataTable({
                "destroy": true,
                "processing": true,
                "serverSide": true,
                "ordering": false,
                "searching": false,
                "ajax": {
                    "url": 'http://localhost:55467/Customer/CustomerList',
                    //"dataSrc": 'apiResources',
                    cache: false,
                    "data": function (data) {
                        data.CustomerName = $('#CustomerName').val();
                        data.CustomerType = $('#CustomerType').val();
                        data.CustomerEmail = $('#CustomerEmail').val();
                        data.CustomerPhoneNumber = $('#CustomerPhoneNumber').val();
                    },
                },
                "columns": [
                    { "data": "name" },
                    { "data": "displayName" },
                    { "data": "description" },
                    { "data": "" }
                ],
                "language": {
                    "url": "/json/Turkish.json"
                },
                "columnDefs": [{
                    "targets": -1,
                    "data": null,
                    "defaultContent":
                        "<button type='button' id='updateButton' class='btn btn-link'><i class='fas fa-pen-alt'></i></button>" +
                        "<button type='button' id='deleteButton' class='btn btn-link'><i class='far fa-trash-alt'></i></button>"
                }]
            });
            DataListGrid = grid;
        }
        $(document).ready(function () {
            fillDataList();
            $('#datatable-ApiList').on('click', '#updateButton', function (e) {
                var data = DataListGrid.row($(this).parents('tr')).data();
                Update(data["id"]);
            });
            $('#datatable-ApiList').on('click', '#deleteButton', function (e) {
                var data = DataListGrid.row($(this).parents('tr')).data();
                Delete(data["id"]);
            });
        });
    </script>


}

